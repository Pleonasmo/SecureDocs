const listaDeQuestoes = [

    {
        pergunta: "O que marca o fim da Pré-História?",
        alternativaA: "O surgimento da agricultura",
        alternativaB: "A invenção da roda",
        alternativaC: "O domínio do fogo",
        alternativaD: "A invenção da escrita",
        alternativaCorreta: "alternativaD"
    },

    {
        pergunta: "Durante o Paleolítico, os humanos:",
        alternativaA: "Já viviam em cidades e praticavam agricultura",
        alternativaB: "Eram sedentários e criavam gado",
        alternativaC: "Eram nômades e usavam ferramentas de pedra lascada",
        alternativaD: "Tinham escrita e sistema de leis",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "Uma conquista crucial do período Paleolítico foi:",
        alternativaA: "A cerâmica",
        alternativaB: "O domínio do fogo",
        alternativaC: "A tecelagem",
        alternativaD: "A criação de moedas",
        alternativaCorreta: "alternativaB"
    },

    {    
        pergunta: "A principal característica do Neolítico foi:",
        alternativaA: "Nomadismo",
        alternativaB: "Uso do ferro",
        alternativaC: "Sedentarismo e agricultura",
        alternativaD: "Pinturas rupestres",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "A Idade dos Metais ficou marcada pela(o):",
        alternativaA: "Invenção da escrita e surgimento das civilizações",
        alternativaB: "Caça e coleta",
        alternativaC: "Vida nômade",
        alternativaD: "Surgimento das pinturas rupestres",
        alternativaCorreta: "alternativaA"
    },

    {
        pergunta: "A Idade Média começou com:",
        alternativaA: "A Revolução Francesa",
        alternativaB: "A tomada de Constantinopla",
        alternativaC: "A queda do Império Romano do Ocidente",
        alternativaD: "O início das Cruzadas",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "O sistema social e econômico dominante na Idade Média era:",
        alternativaA: "Capitalismo",
        alternativaB: "Mercantilismo",
        alternativaC: "Comunismo",
        alternativaD: "Feudalismo",
        alternativaCorreta: "alternativaD"
    },

    {
        pergunta: "No sistema feudal, os servos:",
        alternativaA: "Eram livres e donos de terras",
        alternativaB: "Recebiam salários do rei",
        alternativaC: "Trabalhavam em troca de proteção e subsistência",
        alternativaD: "Viviam nas cidades e eram comerciantes",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "O que caracterizou a Baixa Idade Média?",
        alternativaA: "Expansão islâmica na Europa",
        alternativaB: "Declínio do comércio",                             
        alternativaC: "Renascimento urbano e crescimento das cidades",
        alternativaD: "Fim do cristianismo",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "A Peste Negra causou:",
        alternativaA: "Crescimento da população",
        alternativaB: "Crise econômica e social",
        alternativaC: "Expansão da Igreja Católica",
        alternativaD: "Fim das Cruzadas",
        alternativaCorreta: "alternativaB"
    },

    {
        pergunta: "Um dos marcos iniciais da Idade Moderna foi:",
        alternativaA: "A Revolução Industrial",
        alternativaB: "A queda do Muro de Berlim",
        alternativaC: " A Guerra dos Cem Anos",
        alternativaD: "A tomada de Constantinopla",
        alternativaCorreta: "alternativaD"
    },

    {
        pergunta: "O Renascimento destacou-se por valorizar:",
        alternativaA: "O humanismo e o conhecimento científico",
        alternativaB: "A fé cega e o misticismo",
        alternativaC: "A obediência à Igreja",
        alternativaD: "O sistema feudal",
        alternativaCorreta: "alternativaA"
    },

    {
        pergunta: "A Reforma Protestante foi iniciada por:",
        alternativaA: "João Calvino",
        alternativaB: "Henrique VIII",
        alternativaC: "Santo Agostinho",
        alternativaD: "Martinho Lutero",
        alternativaCorreta: "alternativaD"
    },

    {
        pergunta: "O absolutismo é caracterizado pelo:",
        alternativaA: "Governo parlamentar",
        alternativaB: "Poder compartilhado entre povo e rei",
        alternativaC: "Poder concentrado nas mãos do monarca",
        alternativaD: "Voto direto nas decisões políticas",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "O mercantilismo defendia:",
        alternativaA: "Livre mercado sem intervenção",
        alternativaB: "Acúmulo de riquezas pelo Estado e intervenção na economia",
        alternativaC: "Igualdade de renda",
        alternativaD: "Eliminação de impostos sobre importações",
        alternativaCorreta: "alternativaB"
    },

    {
        pergunta: "A Revolução Francesa foi motivada por:",
        alternativaA: "Apoio ao absolutismo",
        alternativaB: "Interesses coloniais",
        alternativaC: "Expansão do feudalismo",
        alternativaD: "Ideais de liberdade, igualdade e fraternidade",
        alternativaCorreta: "alternativaD"
    },

    {
        pergunta: "A Revolução Industrial teve início na:",
        alternativaA: "Inglaterra",
        alternativaB: "França",
        alternativaC: "Alemanha",
        alternativaD: "Itália",
        alternativaCorreta: "alternativaA"
    },

    {
        pergunta: "A Primeira Guerra Mundial terminou com:",
        alternativaA: "A Revolução Francesa",
        alternativaB: "A queda do Império Romano",
        alternativaC: "O Tratado de Versalhes",
        alternativaD: "A queda do Muro de Berlim",
        alternativaCorreta: "alternativaC"
    },

    {
        pergunta: "A Guerra Fria foi marcada por:",
        alternativaA: "Combates diretos entre EUA e URSS",
        alternativaB: "Paz mundial e cooperação",
        alternativaC: "Fim das alianças militares",
        alternativaD: "Disputas ideológicas e corrida armamentista",
        alternativaCorreta: "alternativaD"
    },

    {
        pergunta: "A globalização é caracterizada por:",
        alternativaA: "Interconexão entre países e mercados",
        alternativaB: "Isolamento econômico dos países",
        alternativaC: "Desconexão cultural e tecnológica",
        alternativaD: "Volta ao feudalismo",
        alternativaCorreta: "alternativaA"
    }
        
]

// variáveis globais:

    let numeroDaQuestaoAtual = 0
    let pontuacaoFinal = 0
    let tentativaIncorreta = 0
    let certas = 0
    let erradas = 0
    let quantidadeDeQuestoes = listaDeQuestoes.length


    function onloadEsconder() {
        document.getElementById('pontuacao').style.display = "none"
        document.getElementById('jogo').style.display = "none"
    }


    function iniciarQuiz() {
        document.getElementById('pontuacao').style.display = "flex"
        document.getElementById('jogo').style.display = "flex"
        document.getElementById('btnIniciarQuiz').style.display = "none"

        document.getElementById('qtdQuestoes').innerHTML = quantidadeDeQuestoes

        preencherHTMLcomQuestaoAtual(0)

        btnSubmeter.disabled = false
        btnProx.disabled = true
        btnTentarNovamente.disabled = true
    }

    function preencherHTMLcomQuestaoAtual(index) {
        habilitarAlternativas(true)
        const questaoAtual = listaDeQuestoes[index]
        numeroDaQuestaoAtual = index
        console.log("questaoAtual")
        console.log(questaoAtual)
        document.getElementById("spanNumeroDaQuestaoAtual").innerHTML = Number(index) + 1
        document.getElementById("spanQuestaoExibida").innerHTML = questaoAtual.pergunta;
        document.getElementById("labelOpcaoUm").innerHTML = questaoAtual.alternativaA;
        document.getElementById("labelOpcaoDois").innerHTML = questaoAtual.alternativaB;
        document.getElementById("labelOpcaoTres").innerHTML = questaoAtual.alternativaC;
        document.getElementById("labelOpcaoQuatro").innerHTML = questaoAtual.alternativaD;
    }

    function submeter() {
        const options = document.getElementsByName("option"); // recupera alternativas no html

        let hasChecked = false
        for (let i = 0; i < options.length; i++) {
            if (options[i].checked) {
                hasChecked = true
                break
            }
        }

        if (!hasChecked) {
            alert("Não há alternativas escolhidas. Escolha uma opção.")
        } else {
            btnSubmeter.disabled = true
            btnProx.disabled = false

            habilitarAlternativas(false)

            checarResposta()
        }
    }

    function habilitarAlternativas(trueOrFalse) {
        let opcaoEscolhida = trueOrFalse ? false : true

        primeiraOpcao.disabled = opcaoEscolhida
        segundaOpcao.disabled = opcaoEscolhida
        terceiraOpcao.disabled = opcaoEscolhida
        quartaOpcao.disabled = opcaoEscolhida

    }

    function avancar() {
        btnProx.disabled = true
        btnSubmeter.disabled = false

        desmarcarRadioButtons()

        if (numeroDaQuestaoAtual < quantidadeDeQuestoes - 1) {
            preencherHTMLcomQuestaoAtual(numeroDaQuestaoAtual)
        } else if (numeroDaQuestaoAtual == quantidadeDeQuestoes - 1) {
            alert("Atenção... a próxima é a ultima questão!")
            preencherHTMLcomQuestaoAtual(numeroDaQuestaoAtual)
        } else {
            finalizarJogo()
        }
        limparCoresBackgroundOpcoes()
    }

    function checarResposta() {
        const questaoAtual = listaDeQuestoes[numeroDaQuestaoAtual] // questão atual 
        const respostaQuestaoAtual = questaoAtual.alternativaCorreta // qual é a resposta correta da questão atual

        const options = document.getElementsByName("option"); // recupera alternativas no html

        let alternativaCorreta = null // variável para armazenar a alternativa correta

        options.forEach((option) => {
            if (option.value === respostaQuestaoAtual) {
                console.log("alternativaCorreta está no componente: " + alternativaCorreta)
                alternativaCorreta = option.labels[0].id
            }
        })

        // verifica se resposta assinalada é correta
        let acertou;
        options.forEach((option) => {
            if (option.checked === true && option.value === respostaQuestaoAtual) {
                acertou = 1
                document.getElementById(alternativaCorreta).classList.add("text-success-with-bg")
                pontuacaoFinal++
                certas++
                document.getElementById("spanCertas").innerHTML = certas
                numeroDaQuestaoAtual++
            } else if (option.checked && option.value !== respostaQuestaoAtual) {
                const wrongLabelId = option.labels[0].id
                acertou = 0
                document.getElementById(wrongLabelId).classList.add("text-danger-with-bg")
                document.getElementById(alternativaCorreta).classList.add("text-success-with-bg")
                tentativaIncorreta++
                erradas++
                document.getElementById("spanErradas").innerHTML = erradas
                numeroDaQuestaoAtual++
            }
        })

        let idUsuario = sessionStorage.ID_USUARIO;

        fetch("/dashboard/submeterResposta", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idQuestaoServer: numeroDaQuestaoAtual,
                pontuacaoServer: acertou,
                idUsuarioServer: idUsuario
            })
        }).then(resultado => {
            console.log(resultado);
        })
    }

    function limparCoresBackgroundOpcoes() {
        const options = document.getElementsByName("option");
        options.forEach((option) => {
            document.getElementById(option.labels[0].id).classList.remove("text-danger-with-bg")
            document.getElementById(option.labels[0].id).classList.remove("text-success-with-bg")
        })
    }

    function desmarcarRadioButtons() {
        const options = document.getElementsByName("option");
        for (let i = 0; i < options.length; i++) {
            options[i].checked = false;
        }
    }

    function finalizarJogo() {

        jogo.innerHTML = `<div class="mensagem_final_quiz">PARABÉNS! <br><br>QUIZ FINALIZADO!</div>`;

        let textoParaMensagemFinal = null;

// HELP ---------------------------------------------------------------------------------------------------------------------
 
        textoParaMensagemFinal = `Você acertou: ${HELP} questões.<br><br>E errou: ${HELP} questões neste questionário.`

        document.getElementById('msgFinal').innerHTML = textoParaMensagemFinal

        document.getElementById('jogo').classList.add("text-new-gray") 

        btnProx.disabled = true
        btnSubmeter.disabled = true
        // btnConcluir.disabled = true
        btnTentarNovamente.disabled = false

    }